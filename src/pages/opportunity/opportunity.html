<ion-header>
  <ion-toolbar>
    <ion-navbar text-center hideBackButton="true" style="padding: 0px !important">
      <ion-grid style="padding: 0px !important">
        <ion-row align-items-center style="justify-content: space-between">
          <ion-col col-auto="">
            <img style="width: 60%;max-width: 50px;" (click)="goBack()" src="assets/imgs/back_button@3x.png">
          </ion-col>
          <ion-col col-auto="">
            <img src="assets/imgs/firsat_header@3x.png" style="margin-left: -13px;max-width: 80px;">
          </ion-col>
          <ion-col col-auto="">
            <img style="width: 60%;max-width: 50px;" (click)="shareDeal()" src="assets/imgs/paylas_button@3x.png">
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-navbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-row [ngClass]="itemone ? 'toLogoUp' : 'toLogoDown'" text-center>
    <ion-col style="font-family: MarkPro-Heavy;font-size: 20px;color:#234491;margin-top: 20px" align-self-center>
      <span>{{opportunity.title}}</span>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col col-auto style="    margin-left: auto;
    margin-right: auto;">
      <img style="max-width: 200px;
    margin-top: 20px;
    margin-bottom: 20px" src="{{opportunity.image_url}}">
    </ion-col>
  </ion-row>
  <ion-row style="justify-content: space-around">
    <ion-col col-auto>
      <ion-row>
        <ion-col>
          <img style="width: 50px" src="assets/svgs/price_tag.svg">
        </ion-col>
        <ion-col>
          <ion-label [ngStyle]="{'font-size':isPriceToolong()}"
                     style="font-family: MarkPro-Black;font-size: 18px;color:#234491">{{whatIsPrice()}}
          </ion-label>
        </ion-col>
      </ion-row>
    </ion-col>
    <ion-col style="padding: 0px !important;display: flex;align-items: center;justify-content: center" col-5>
      <div style="background-color: #F7E60F;border-radius: 20px 20px 20px 20px;width: 100%">
        <ion-grid style="padding: 0px !important;">
          <ion-row style="padding: 0px !important;">
            <ion-col style="padding: 0px !important;display: flex;align-items: center" col-4>
              <img style="border-radius: 50%;width: 40px;height: 40px;" src="{{opportunity.user.avatar_url}}">
            </ion-col>
            <ion-col style="padding: 0px !important;display: flex;align-items: center" col-8>
              <span style="font-family: MarkPro-Heavy;font-size: 15px;color:#234491;word-break: normal">{{opportunity.user.name.substr(0,14)}}</span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col>
      <img style="transform: scale(0.9)" src="assets/imgs/seperator_line@3x.png">
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col style="margin-left: 18px">
      <span style="font-family: MarkPro-Medium;font-size: 15px;color:#234491">{{opportunity.details}}</span>
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col>
      <img style="transform: scale(0.9)" src="assets/imgs/seperator_line@3x.png">
    </ion-col>
  </ion-row>
  <ion-row align-items-center style="justify-content: space-around;flex-wrap: nowrap">
    <ion-col col-auto>
      <ion-row style="max-width: 100px;    text-align: center;
    flex-wrap: nowrap;
    align-items: center;">
        <ion-col push-2>
          <div no-padding id="lottieLikeButton" (click)="playAnim(0,'like')"></div>
        </ion-col>
        <ion-col>
          <span class="like-button-text">
          {{opportunity.votes_sum}}
        </span>
        </ion-col>
      </ion-row>
    </ion-col>
    <ion-col col-auto>
      <img style="max-width: 120px;    " (click)="onOutsideDealLink(opportunity)" src="assets/imgs/firsata_git_button@3x.png">
    </ion-col>
    <ion-col col-auto>
      <ion-row style="max-width: 100px;        text-align: center;
    flex-wrap: nowrap;
    align-items: center;">
        <ion-col push-2>
          <div no-padding id="lottieCommentButton">

          </div>
        </ion-col>
        <ion-col>
          <span class="like-button-text">
          {{opportunity.comments_count}}
          </span>
        </ion-col>
      </ion-row>

    </ion-col>

  </ion-row>
  <!--<ion-row *ngIf="!dealReported">
    <ion-col style="text-align: right;padding-bottom: 1%">
      <img src="assets/svgs/problemli_line.svg">
    </ion-col>
  </ion-row>
  <ion-row>
    <ion-col @commentState class="col" *ngIf="dealReported">
      <span
        style="font-family: 'Mark Pro-Book';font-size: 15px;color:#234491">BİZİ BİLGİLENDİRDİĞİN İÇİN TEŞEKKÜRLER :)</span>
    </ion-col>
    <ion-col *ngIf="!dealReported">
      <ion-row style="padding-top: 10px;flex-wrap: nowrap;">
        <ion-col col-4>
          <ion-row>
            <ion-col col-12 text-center>
              <img src="assets/svgs/suresi_dolmus_icon.svg" class="imgClass">
            </ion-col>
            <ion-col (click)="deadOnDeadLine()" text-center>
              <span
                style="font-family: 'MarkPro-Book';font-size: 8px;color:#234491;white-space: nowrap">SÜRESİ DOLMUŞ</span>
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col col-4>
          <ion-row>
            <ion-col col-12 text-center>
              <img src="assets/svgs/tukenmis_icon.svg" class="imgClass">
            </ion-col>
            <ion-col (click)="dealOutOfStock()" text-center>
              <span style="font-family: 'MarkPro-Book';font-size: 8px;color:#234491">TÜKENMİŞ</span>
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col col-4>
          <ion-row>
            <ion-col col-12 text-center>
              <img src="assets/svgs/sikayet_et_icon.svg" class="imgClass">
            </ion-col>
            <ion-col (click)="onReportDeal()" text-center>
              <span
                style="font-family: 'MarkPro-Book';font-size: 8px;color:#234491;white-space: nowrap">ŞİKAYET ET</span>
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>
    </ion-col>
  </ion-row>-->
  <ion-row style="flex-wrap: nowrap;justify-content: center">
    <ion-col col-6 text-center="">
      <span style="font-family: MarkPro-Heavy;font-size: 16px;color:#234491">YORUMLAR</span>
    </ion-col>
  </ion-row>
  <ion-list [ngClass]="itemfour ? 'toLogoUp' : 'toLogoDown'">
    <div *ngFor="let comment of newlyAddedComments">
      <div *ngIf="newlyAddedComments.length > 0" id="newlyAdded" ngClass="highlighted">
        <div style="margin-top: 16px;background-color:#E5E5E5;border-radius: 20px 20px 20px 20px;transform: scale(0.9)">
          <ion-row style="background-color: #F7E60F;border-radius: 20px 20px 20px 20px">
            <ion-col col-2>
              <ion-avatar>
                <img style="border-radius: 20px;height: 40px;width: 40px;" src="{{comment.user.avatar_url}}">
              </ion-avatar>
            </ion-col>
            <ion-col style="padding: 0px !important;display: flex;align-items: center" col-8>
              <span style="font-family: MarkPro-Heavy;font-size: 15px;color:#234491">{{comment.user.name}}</span>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col style="margin: 5px">
        <span *ngIf="comment.showContent"
              [@onCommentExpand]="comment.showContent ? 'toExpand' : 'asd'">{{comment.text}}</span>
              <span style="font-family: MarkPro-Book;font-size: 15px;color:#234491"
                    (click)="comment.showContent = !comment.showContent"
                    *ngIf="!comment.showContent">{{comment.text}}</span>
            </ion-col>
          </ion-row>
        </div>
      </div>
    </div>

    <div *ngFor="let comment of comments;let i = index" id="{{comment.newlyAdded}}"

         ngClass="highlighted">
      <div style="margin-top: 16px;background-color:#E5E5E5;border-radius: 20px 20px 20px 20px;transform: scale(0.9)">
        <ion-row style="background-color: #F7E60F;border-radius: 20px 20px 20px 20px">
          <ion-col col-2>
            <ion-avatar>
              <img style="border-radius: 20px;height: 40px;width: 40px;" src="{{comment.user.avatar_url}}">
            </ion-avatar>
          </ion-col>
          <ion-col style="padding: 0px !important;display: flex;align-items: center" col-8>
            <span style="font-family: MarkPro-Heavy;font-size: 15px;color:#234491">{{comment.user.name}}</span>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col style="margin: 5px">
        <span *ngIf="comment.showContent"
              [@onCommentExpand]="comment.showContent ? 'toExpand' : 'asd'">{{comment.text}}</span>
            <span style="font-family: MarkPro-Book;font-size: 15px;color:#234491"
                  (click)="comment.showContent = !comment.showContent"
                  *ngIf="!comment.showContent">{{comment.text}}</span>
          </ion-col>
        </ion-row>
        <ion-row style="    margin-top: 20px;">
          <ion-col col-2 push-7>
            <!--<img style="    position: absolute;
    top: -220%;" (click)="onCommentReply({comment:comment,opportunity:opportunity})"
                 src="assets/imgs/reply_icon@3x.png">-->
          </ion-col>
          <ion-col col-3 push-7>
            <!--<div class="lottieThumbUpButton" style="    position: absolute;
    top: -220%;" (click)="playAnim(i,'thumbsUp',comment)">
            </div>-->
          </ion-col>

        </ion-row>
      </div>
      <div *ngFor="let subComment of comment.comments;let i=index">
        <ion-row style="padding-left: 15%">
          <ion-col *ngIf="i<comment.showUntil"
                   style="margin-top: 16px;background-color:#E5E5E5;border-radius: 20px 20px 20px 20px;transform: scale(0.9);padding: 0px">
            <ion-row style="background-color: #F7E60F;border-radius: 20px 20px 20px 20px">
              <ion-col col-2>
                <ion-avatar>
                  <img style="border-radius: 20px;height: 40px;width: 40px;" src="{{subComment.user.avatar_url}}">
                </ion-avatar>
              </ion-col>
              <ion-col style="padding: 0px !important;display: flex;align-items: center" col-8>
                <span style="font-family: MarkPro-Heavy;font-size: 15px;color:#234491">{{subComment.user.name}}</span>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="margin: 5px">
                <span *ngIf="subComment.showContent" [@onCommentExpand]="subComment.showContent ? 'toExpand' : 'asd'">{{subComment.text}}</span>
                <span style="font-family: MarkPro-Book;font-size: 15px;color:#234491"
                      (click)="subComment.showContent = !subComment.showContent"
                      *ngIf="!subComment.showContent">{{subComment.text}}</span>
              </ion-col>
            </ion-row>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="i === comment.comments.length-1"
                 style="margin-top: 2%;text-align: end;margin-top: 2%;margin-right: 20px;">
          <ion-col (click)="addSubcommentIndex(comment,i)">
            <span
              style="font-family: 'MarkPro-Medium';font-size: 11px;color:#234491">{{comment.dahaFazlaGetirText}}</span>
          </ion-col>
        </ion-row>
      </div>
    </div>
  </ion-list>
  <ion-infinite-scroll (ionInfinite)="doInfinite($event)" threshold="100px">
    <ion-infinite-scroll-content
      loadingSpinner="bubbles"
      loadingText="Yükleniyor...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>

<!--<ion-footer>
  <form #f="ngForm" (submit)="onCommentSubmit(f)">
    <ion-grid>
      <ion-row>
        &lt;!&ndash;<ion-col col-2 style="text-align: center" align-self-center>
          <button>
            <ion-icon style="font-size: xx-large;font-weight: 900;color:#2FA4E7" name="add"></ion-icon>
          </button>
        </ion-col>&ndash;&gt;
        <ion-col col-8>
          <ion-item no-lines>
            <ion-input required [ngModel] name="comment"
                       style="padding:0 0 0 10px;font-size:15px;background-color: #f0ecec;border-radius: 64px"
                       type="text" placeholder="Düşüncelerin neler ?"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-2 text-center align-self-center style="background: white">
          <button type="submit"
                  [disabled]="!f.valid"
                  style="background: white">
            <img src="assets/imgs/dusuncelerin_neler_icon@3x.png">
          </button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ion-footer>-->
